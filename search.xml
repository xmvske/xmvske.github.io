<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>HOME</title>
      <link href="/2022/02/10/hello-world/"/>
      <url>/2022/02/10/hello-world/</url>
      
        <content type="html"><![CDATA[<p>æƒ¯æœ‰è°£è¯¼æˆ–é’çœ¼ï¼Œä½•é¡»ä»–äººç½®ä¸€è¨€ã€‚<span class="github-emoji"><span>ğŸ˜„</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Springboot æ•´åˆ webSocket æ— æ³•å¯åŠ¨é—®é¢˜è®°å½•</title>
      <link href="/2020/06/01/spring-boot-zheng-he-websocket-bao-cuo-ji-lu/"/>
      <url>/2020/06/01/spring-boot-zheng-he-websocket-bao-cuo-ji-lu/</url>
      
        <content type="html"><![CDATA[<h2 id="Springboot-æ•´åˆ-webSocket-æ— æ³•å¯åŠ¨é—®é¢˜è®°å½•"><a href="#Springboot-æ•´åˆ-webSocket-æ— æ³•å¯åŠ¨é—®é¢˜è®°å½•" class="headerlink" title="Springboot æ•´åˆ webSocket æ— æ³•å¯åŠ¨é—®é¢˜è®°å½•"></a>Springboot æ•´åˆ webSocket æ— æ³•å¯åŠ¨é—®é¢˜è®°å½•</h2><h3 id="é”™è¯¯ç°è±¡"><a href="#é”™è¯¯ç°è±¡" class="headerlink" title="é”™è¯¯ç°è±¡"></a>é”™è¯¯ç°è±¡</h3><p><strong>ä½¿ç”¨@Componentæ³¨è§£åæ— æ³•å¯åŠ¨</strong>:</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span><span class="token annotation punctuation">@ServerEndpoint</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/websocket/chat/{info}"</span><span class="token punctuation">,</span> configurator <span class="token operator">=</span> <span class="token class-name">MySpringConfigurator</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChatWebSocketServer</span> <span class="token punctuation">{</span><span class="token comment">//...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h3><p><strong>åŸå› 1ï¼šSessionåŒ…å¼•ç”¨é”™è¯¯ã€æ›¿æ¢æˆwebsocketä¸‹çš„Session</strong></p><blockquote><p>import javax.websocket.Session</p></blockquote><p><strong>åŸå› 2ï¼šonOpenæ–¹æ³•æœªä½¿ç”¨@PathParamæ³¨è§£</strong></p><blockquote><p>æ³¨ï¼šonOpenä¸­é™¤Sessionã€EndpointConfigç±»å‹çš„å‚æ•°å¤–å¿…é¡»ä½¿ç”¨@PathParamæ³¨è§£</p></blockquote><p><strong>åŸå› 3ï¼šonErroræ–¹æ³•æœªè®¾ç½®Throwableå‚æ•°</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@OnError</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">// ......</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å…³äºä»¥ä¸Šé—®é¢˜çš„å‘ç”ŸåŸå› éƒ½å¯ä»¥åœ¨æºç ä¸­æ‰¾åˆ°ï¼Œæˆ‘å°†æºç æ–¹æ³•åˆ—åœ¨ä¸‹é¢ï¼Œæ ‡æ˜äº†ä¸€äº›ç®€çŸ­çš„æ³¨é‡Šï¼Œè¿™é‡Œå°±ä¸è¿‡å¤šåˆ†æäº†ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹çœ‹ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">PojoPathParam</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getPathParams</span><span class="token punctuation">(</span><span class="token class-name">Method</span> m<span class="token punctuation">,</span>        <span class="token class-name">MethodType</span> methodType<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">DeploymentException</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PojoPathParam</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">boolean</span> foundThrowable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> types <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">getParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Annotation</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramsAnnotations <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">getParameterAnnotations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">PojoPathParam</span><span class="token punctuation">[</span><span class="token punctuation">]</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PojoPathParam</span><span class="token punctuation">[</span>types<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">// é‡ç‚¹åœ¨è¿™ä¸€æ®µ</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> types<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> type <span class="token operator">=</span> types<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment">// æ£€æŸ¥ä½ çš„Sessionç±»å‹</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Session</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PojoPathParam</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ£€æŸ¥EndpointConfigç±»å‹</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>methodType <span class="token operator">==</span> <span class="token class-name">MethodType</span><span class="token punctuation">.</span>ON_OPEN <span class="token operator">&amp;&amp;</span>                type<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">EndpointConfig</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PojoPathParam</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ£€æŸ¥ON_ERRORæ˜¯å¦æºå¸¦Throwableå‚æ•°</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>methodType <span class="token operator">==</span> <span class="token class-name">MethodType</span><span class="token punctuation">.</span>ON_ERROR                <span class="token operator">&amp;&amp;</span> type<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            foundThrowable <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PojoPathParam</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>methodType <span class="token operator">==</span> <span class="token class-name">MethodType</span><span class="token punctuation">.</span>ON_CLOSE <span class="token operator">&amp;&amp;</span>                type<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">CloseReason</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PojoPathParam</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token comment">// å¦‚æœå‚æ•°ä¸æ»¡è¶³ä¸Šè¿°ç±»å‹ï¼Œåˆ™æ£€æŸ¥æ˜¯å¦æ ‡æœ‰@PathParamæ³¨è§£</span>            <span class="token class-name">Annotation</span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramAnnotations <span class="token operator">=</span> paramsAnnotations<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Annotation</span> paramAnnotation <span class="token operator">:</span> paramAnnotations<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>paramAnnotation<span class="token punctuation">.</span><span class="token function">annotationType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>                        <span class="token class-name">PathParam</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PojoPathParam</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span>                            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">PathParam</span><span class="token punctuation">)</span> paramAnnotation<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            <span class="token comment">// ä¸å…è®¸ä½¿ç”¨æ²¡æœ‰æ³¨è§£çš„å‚æ•°</span>            <span class="token comment">// Parameters without annotations are not permitted</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">DeploymentException</span><span class="token punctuation">(</span>sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>                        <span class="token string">"pojoMethodMapping.paramWithoutAnnotation"</span><span class="token punctuation">,</span>                        type<span class="token punctuation">,</span> m<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> m<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment">//ON_ERRORæœªæºå¸¦Throwableå‚æ•°æ—¶æŠ›å‡ºçš„å¼‚å¸¸</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>methodType <span class="token operator">==</span> <span class="token class-name">MethodType</span><span class="token punctuation">.</span>ON_ERROR <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>foundThrowable<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">DeploymentException</span><span class="token punctuation">(</span>sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>                <span class="token string">"pojoMethodMapping.onErrorNoThrowable"</span><span class="token punctuation">,</span>                m<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> m<span class="token punctuation">.</span><span class="token function">getDeclaringClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœè¿˜æœ‰å…¶ä»–å…³äºSpringboot æ•´åˆ webSocket å¯åŠ¨æŠ¥é”™çš„é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºè¯´æ˜ã€‚<br>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/a499957739/article/details/105806092?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.nonecase">Springboot2.0 é›†æˆ websocket å‡ºç° Failed to register @ServerEndpoint class é—®é¢˜.</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
